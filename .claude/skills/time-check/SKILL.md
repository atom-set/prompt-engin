---
name: time-check
description: 时间字段强制检查机制，创建包含时间字段的文档时，必须先通过工具获取当前时间
tags: [rules, prompt-engine]
---

# 概述

## 使用场景

当用户需要：
- **应用此规范**时，自动加载此技能

## 触发条件

以下情况自动应用此规范：
- 用户要求应用相关规范时
- AI 助手识别到需要使用此规范时

## 与其他规则的配合

- 与其他规则技能配合使用
- 与核心规则配合使用

---

# Time Check

> **文件说明**：本文件包含 Act 模式下时间字段的强制检查机制
> **规则来源**：rules/stages/common/mode/act/time-check.md
> **相关规范**：时间格式要求请参考 `prompts/stages/common/document/time-format.md`

---

## 概述

本文件定义了 Act 模式下时间字段的强制检查机制，确保在创建包含时间字段的文档时，必须先通过工具获取当前时间，严禁使用假设时间。适用于所有包含时间字段的文档创建和修改场景，包括创建时间、更新时间、日期等。

---

#### 时间字段强制检查机制（Act 模式）⚠️

**核心原则**：创建包含时间字段的文档时，必须先通过工具获取当前时间，严禁使用假设时间！

**适用场景**：在 Act 模式下创建或修改包含时间字段的文档（如创建时间、更新时间、日期等）

**时间格式规范**：
- ⚠️ **重要**：时间格式要求、禁止的时间值、获取时间方法等详细规范，请参考 `prompts/stages/common/document/time-format.md`
- 本文件仅包含 Act 模式下的检查流程和机制

---

**检查流程**（强制执行）：

1. **第一步：识别时间字段**
   - 检测文档内容是否包含时间相关字段：
     - "创建时间"、"最后更新"、"更新时间"、"日期"等关键词
     - 日期格式的字符串（如 `YYYY-MM-DD`）
   - 如果包含，必须进入时间检查流程

2. **第二步：获取当前时间**（强制步骤）
   ```bash
   # 必须先运行此命令获取当前日期
   date '+%Y-%m-%d'
   
   # 或获取完整日期时间
   date '+%Y-%m-%d %H:%M:%S'
   ```

3. **第三步：使用获取的时间填写文档**
   - 将第二步获取的时间填入文档的时间字段
   - 禁止使用任何硬编码或假设的日期

4. **第四步：禁止值检查**
   - 检查是否使用了禁止的时间值（详细禁止清单请参考 `time-format.md`）
   - 主要禁止项：
     - ❌ 任何具体日期（如 `2025-01-21`、`2025-01-17`、`2025-12-01`）
     - ❌ 格式占位符（如 `YYYY-MM-DD`）
     - ❌ 模糊表述（如"今天"、"当前日期"）
     - ❌ 不先获取就填写的任何日期

---

**强制检查清单**（每次写入文件前必查）：

- [ ] **已识别文档中的时间字段**
- [ ] **已运行 `date` 命令获取当前时间**（获取方法参考 `time-format.md`）
- [ ] **已将获取的时间填入文档**
- [ ] **没有使用禁止的时间值**（详细禁止清单参考 `time-format.md`）

---

**禁止的做法**（严格执行）：

详细禁止清单和示例请参考 `time-format.md`，主要禁止项：
- ❌ 直接写入具体日期（未运行 date 命令）
- ❌ 使用格式占位符（如 `YYYY-MM-DD`）
- ❌ 使用模糊表述（如"今天"、"当前日期"）

**正确的做法**：

```typescript
// ✅ 正确流程：

// 第一步：获取当前时间（获取方法参考 time-format.md）
run_terminal_cmd("date '+%Y-%m-%d'");
// 返回结果：2025-12-01

// 第二步：使用获取的时间创建文档
write("file.md", "> **创建时间**: 2025-12-01（本地时间）");
```

---

**拦截机制**：

如果发现以下情况，必须停止执行并纠正：

1. **检测到假设日期**：
   - 在要写入的内容中发现 `2025-XX-XX` 格式的日期
   - 在要写入的内容中发现 `YYYY-MM-DD` 占位符
   - 提示："⚠️ 检测到假设日期，请先运行 date 命令获取当前时间"

2. **未运行 date 命令就写入时间**：
   - 如果文档包含时间字段，但之前没有运行 `date` 命令
   - 提示："⚠️ 检测到时间字段，必须先运行 date 命令"

3. **使用模糊表述**：
   - 发现"今天"、"当前日期"等表述
   - 提示："⚠️ 禁止使用模糊表述，请运行 date 命令获取具体日期"

---

**记忆锚点**（强化记忆）：

**每次看到时间字段，立即想到：**

🔥 **先运行 date！**

**创建包含时间的文档的标准流程：**

```
1. run_terminal_cmd("date '+%Y-%m-%d'")  // 第一步：获取时间
2. 记下返回的日期（如：2025-12-01）
3. write("file.md", "创建时间: 2025-12-01") // 第二步：使用获取的时间
```

**任何具体日期都不能直接使用，只有 date 命令返回的日期才能使用！**

---

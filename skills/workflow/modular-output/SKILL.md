---
name: modular-output
description: 完整方案模块化输出策略，适用于复杂内容的输出
priority: 4
tags: ['mode', 'output', 'modular']
---

# 完整方案模块化输出策略

## 使用场景

当用户需要：
- 输出复杂方案时
- 内容较多需要分模块时
- 用户要求分步输出时

## 触发条件

以下情况自动应用此规范：
- 检测到输出内容复杂时
- 用户要求分模块输出时

## 与其他规则的配合

- 与核心规则配合使用

---

> **文件说明**：本文件包含完整方案模块化输出策略
> **规则来源**：rules/stages/common/mode/plan/modular-output.md

---

对于完整技术方案、设计方案等复杂内容的输出，应采用**模块化输出**策略，便于用户理解和确认：

- **适用场景**：
  - 完整的技术方案、设计方案
  - 包含多个逻辑部分的复杂方案
  - 需要分步骤确认的方案内容
  
- **常见模块类型**：
  1. **整体框架**：方案的整体架构、核心思路、主要组成部分
  2. **方案设计**：详细设计说明、技术选型、实现思路、关键决策
  3. **代码框架**：代码结构、关键接口、实现要点、代码示例
  4. **实施计划**：开发步骤、时间安排、注意事项、依赖关系
  5. **其他模块**：根据具体方案类型，可包含测试策略、部署方案、风险评估等

- **模块划分原则**：
  - **划分依据**：
    1. **功能维度**：按功能模块划分（如：用户模块、订单模块、支付模块）
    2. **层次维度**：按架构层次划分（如：前端、后端、数据库）
    3. **阶段维度**：按实施阶段划分（如：设计、开发、测试、部署）
    4. **复杂度维度**：按复杂度划分（如：核心模块、辅助模块、工具模块）
  - **划分标准**：
    1. **单一职责**：每个模块应有明确的单一主题或职责
    2. **相对独立**：模块之间应相对独立，减少强耦合
    3. **合理粒度**：模块大小适中，建议每个模块 200-1000 字
    4. **逻辑清晰**：模块划分应符合逻辑，便于理解
  - **模块大小控制**：
    - **过大模块**（>1000字）：应进一步拆分为子模块
    - **适中模块**（200-1000字）：保持现状
    - **过小模块**（<200字）：考虑合并到相关模块
  - **依赖关系处理**：
    1. **依赖识别**：明确模块之间的依赖关系
    2. **输出顺序**：先输出被依赖的模块，再输出依赖其他模块的模块
    3. **依赖说明**：在模块输出时，说明与其他模块的关系
  - **灵活性原则**：
    1. **方案类型适配**：根据方案类型（技术方案、设计方案、实施方案等）调整模块划分
    2. **用户需求优先**：优先考虑用户的需求和理解习惯
    3. **动态调整**：根据用户反馈，动态调整模块划分

- **输出流程**：
  1. **第一步：输出模块列表**
     - 先列出方案将包含的所有模块
     - 说明每个模块的主要内容
     - 询问用户是否需要调整模块划分
  
  2. **第二步：按模块顺序输出**
     - 按照逻辑顺序（整体框架 → 方案设计 → 代码框架 → 实施计划）逐个输出
     - 每个模块独立输出，使用清晰的标题分隔
     - 每个模块输出后，可询问用户是否需要调整或继续下一模块
  
  3. **第三步：总结确认**
     - 所有模块输出完成后，提供方案总结
     - 确认是否有遗漏或需要补充的内容

- **输出方式**：
  - ✅ 每个模块使用独立的标题（如"## 1. 整体框架"）
  - ✅ 模块之间使用分隔线区分
  - ✅ 每个模块内容完整、可独立理解
  - ✅ 支持用户要求跳过某个模块或调整输出顺序

- **优势**：
  - ✅ 避免一次性输出过长内容，提高可读性
  - ✅ 便于用户分步确认和调整
  - ✅ 降低理解难度，提高方案质量
  - ✅ 支持灵活的交互和调整

### 使用场景示例

#### 示例1：大型技术方案输出

**场景**：用户要求设计一个完整的用户认证系统，包含多个模块

**模块划分**：
```
1. 整体框架：系统架构、核心思路、主要组成部分
2. 方案设计：认证流程设计、技术选型、安全策略
3. 代码框架：API 接口设计、数据库设计、关键代码结构
4. 实施计划：开发步骤、测试策略、部署方案
5. 风险评估：安全风险、性能风险、兼容性风险
```

**输出流程**：
```markdown
# 用户认证系统技术方案

## 模块列表

本方案将分为以下 5 个模块输出：

1. **整体框架**：系统架构、核心思路、主要组成部分
2. **方案设计**：认证流程设计、技术选型、安全策略
3. **代码框架**：API 接口设计、数据库设计、关键代码结构
4. **实施计划**：开发步骤、测试策略、部署方案
5. **风险评估**：安全风险、性能风险、兼容性风险

是否需要调整模块划分？如无异议，将按顺序输出各模块。

---

## 1. 整体框架

[输出整体框架内容...]

---

## 2. 方案设计

[输出方案设计内容...]

---

## 3. 代码框架

[输出代码框架内容...]

---

## 4. 实施计划

[输出实施计划内容...]

---

## 5. 风险评估

[输出风险评估内容...]

---

## 方案总结

[总结所有模块的核心要点...]
```

#### 示例2：复杂重构方案输出

**场景**：用户要求重构一个大型模块，涉及多个文件和功能

**模块划分**（按功能模块划分）：
```
1. 重构概述：重构目标、影响范围、重构策略
2. 用户模块重构：用户模块的重构方案
3. 订单模块重构：订单模块的重构方案
4. 支付模块重构：支付模块的重构方案
5. 迁移计划：数据迁移、代码迁移、测试计划
```

**输出流程**：
```markdown
# 系统重构方案

## 模块列表

本方案将分为以下 5 个模块输出：

1. **重构概述**：重构目标、影响范围、重构策略
2. **用户模块重构**：用户模块的重构方案
3. **订单模块重构**：订单模块的重构方案
4. **支付模块重构**：支付模块的重构方案
5. **迁移计划**：数据迁移、代码迁移、测试计划

---

## 1. 重构概述

[输出重构概述内容...]

---

## 2. 用户模块重构

[输出用户模块重构内容...]

---

## 3. 订单模块重构

[输出订单模块重构内容...]

---

## 4. 支付模块重构

[输出支付模块重构内容...]

---

## 5. 迁移计划

[输出迁移计划内容...]
```

#### 示例3：分阶段输出复杂方案

**场景**：用户要求设计一个微服务架构，内容非常复杂

**模块划分**（按架构层次划分）：
```
1. 架构设计：整体架构、服务划分、技术栈选型
2. 服务设计：各个微服务的设计方案
3. 接口设计：服务间接口设计、API 设计
4. 部署方案：容器化方案、编排方案、监控方案
5. 实施计划：分阶段实施计划、测试策略
```

**输出流程**：
```markdown
# 微服务架构设计方案

## 模块列表

本方案将分为以下 5 个模块输出：

1. **架构设计**：整体架构、服务划分、技术栈选型
2. **服务设计**：各个微服务的设计方案
3. **接口设计**：服务间接口设计、API 设计
4. **部署方案**：容器化方案、编排方案、监控方案
5. **实施计划**：分阶段实施计划、测试策略

---

## 1. 架构设计

[输出架构设计内容...]

**是否需要调整此模块？如无异议，将继续输出下一模块。**

---

## 2. 服务设计

[输出服务设计内容...]

**是否需要调整此模块？如无异议，将继续输出下一模块。**

---

[继续输出其他模块...]
```

#### 示例4：用户要求跳过某个模块

**场景**：输出过程中，用户要求跳过某个模块

**处理方式**：
```markdown
## 3. 代码框架

[输出代码框架内容...]

---

**用户反馈**：可以跳过"实施计划"模块，直接看"风险评估"

---

## 5. 风险评估（跳过实施计划）

[输出风险评估内容...]

---

## 方案总结

[总结已输出模块的核心要点...]

**注意**：已跳过"实施计划"模块，如需要可随时补充。
```

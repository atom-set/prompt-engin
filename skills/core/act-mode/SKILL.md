---
name: act-mode
description: Act 模式行为规范，定义 Act 模式下的执行规范
priority: 2
tags: ['core', 'mode', 'act']
---

# Act 模式行为规范

## 使用场景

当用户需要：
- Act 模式下执行时
- 执行代码修改时
- 需要确认计划时

## 触发条件

以下情况自动应用此规范：
- Act 模式下自动应用
- 执行修改时自动应用

## 与其他规则的配合

- **依赖关系**：
  - `mode-common`：模式切换规则、响应格式规范等通用规则，Act 模式必须遵循
  - `file-write`：Act 模式下执行文件写入操作时，必须遵循文件写入规则（文件大小检查、写入策略等）
- 与核心规则配合使用

---

# Act 模式行为规范

---

- 只有在用户输入"Act"指令后才能进入
- **执行实际代码修改前，必须先确认计划**：
  1. 在执行任何代码修改前，必须简要回顾之前输出的方案和计划
  2. 如果当前执行的修改与之前输出的方案不一致，必须停止并提醒用户
  3. 如果用户要求执行新的修改（与之前方案不同），必须返回 Plan 模式重新输出方案
  4. 确认计划后，按照方案和计划执行修改
- 执行修改后，自动返回Plan模式

#### 执行过程中发现方案有问题的处理

- **触发条件**：执行过程中（不是执行前）发现方案有问题，包括：
  - 方案描述与实际代码不一致
  - 方案遗漏重要步骤
  - 方案存在逻辑错误
  - 执行过程中遇到未预料的问题

- **处理流程**：
  1. **立即停止**：停止当前执行
  2. **说明问题**：明确说明发现的问题
  3. **返回 Plan 模式**：切换到 Plan 模式
  4. **输出修正方案**：输出修正后的详细方案（5 个部分）
  5. **等待确认**：等待用户输入 "Act" 后再继续执行

- **问题说明要求**：
  - 必须明确说明发现的具体问题
  - 必须说明问题的影响范围
  - 必须说明修正方案与原方案的区别

- **禁止的行为**：
  - ❌ 继续执行，忽略发现的问题
  - ❌ 不说明问题，直接修正
  - ❌ 不返回 Plan 模式，在 Act 模式下直接修正方案
- **规则文件修改的特殊处理**：
  - 修改规则文件本身（如 `plan-act-mode.md`、`.cursorrules` 等）也必须遵循 Plan 模式
  - 修改规则文件前，必须输出详细的修改方案和计划
  - 修改规则文件后，必须运行合并脚本更新主规则文件
  - 规则文件的修改具有更高的风险，需要特别谨慎

### 使用场景示例

#### 示例1：执行代码修改

**场景**：用户要求修改某个功能，已输出完整方案，用户输入 "Act" 指令

**执行流程**：
```
1. 用户输入 "Act"
2. 检查方案完整性（5个部分）
3. 切换到 Act 模式
4. 简要确认计划："准备执行以下修改：修改文件A、创建文件B"
5. 执行修改操作
6. 修改完成后，自动返回 Plan 模式
```

#### 示例2：执行过程中发现方案问题

**场景**：执行过程中发现方案描述与实际代码不一致

**执行流程**：
```
1. 执行过程中发现问题
2. 立即停止执行
3. 说明问题："发现方案中描述的函数名与实际代码不一致"
4. 返回 Plan 模式
5. 输出修正方案（5个部分）
6. 等待用户再次输入 "Act"
```

#### 示例3：用户要求新修改

**场景**：Act 模式下，用户要求执行新的修改（与当前计划不同）

**执行流程**：
```
1. 识别新需求："修改另一个功能"
2. 立即停止当前执行
3. 返回 Plan 模式
4. 输出新需求的详细方案（5个部分）
5. 等待用户输入 "Act" 后再执行
```
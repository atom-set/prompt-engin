# Act 模式行为规范

> **文件说明**：本文件包含 Act 模式的基础行为规范
> **规则来源**：rules/stages/common/mode/act/behavior.md

---

## 概述

本文件定义了 Act 模式的基础行为规范，包括模式切换条件、执行确认机制、问题处理流程等核心机制。Act 模式是执行模式，只有在用户明确输入"Act"指令后才能进入，用于执行代码修改、创建文件、删除文件等操作。

---

## 核心原则（最高优先级）

**⚠️ 进入Act模式的唯一条件**：只有用户明确输入"Act"指令（不区分大小写）才能进入Act模式。

**模式切换的强制规则**（简化版）：
- **无Act指令时统一按Plan模式**：任何情况下，如果用户没有输入"Act"指令，都必须保持在Plan模式（最高优先级规则）
- **唯一进入条件**：只有用户明确输入"Act"指令（不区分大小写）且方案完整才能进入Act模式
- **前置要求**：必须已输出完整方案（5个部分）
- **检查流程**：用户输入"Act" → 检查方案完整性 → 方案完整则进入，否则保持在Plan模式
- **禁止复杂判断**：不能进行任何复杂的判断，只需检查是否有"Act"指令，没有则统一按Plan模式处理

---

- 只有在用户输入"Act"指令后才能进入
- **重要**：当用户没有输出"Act"指令时，系统统一按Plan模式处理，不会进入Act模式
- **执行实际代码修改前，必须先确认计划**：
  1. 在执行任何代码修改前，必须简要回顾之前输出的方案和计划
  2. 如果当前执行的修改与之前输出的方案不一致，必须停止并提醒用户
  3. 如果用户要求执行新的修改（与之前方案不同），必须返回 Plan 模式重新输出方案
  4. 确认计划后，按照方案和计划执行修改
- 执行修改后，自动返回Plan模式

#### 执行过程中发现方案有问题的处理

- **触发条件**：执行过程中（不是执行前）发现方案有问题，包括：
  - 方案描述与实际代码不一致
  - 方案遗漏重要步骤
  - 方案存在逻辑错误
  - 执行过程中遇到未预料的问题

- **处理流程**：
  1. **立即停止**：停止当前执行
  2. **说明问题**：明确说明发现的问题
  3. **返回 Plan 模式**：切换到 Plan 模式
  4. **输出修正方案**：输出修正后的详细方案（5 个部分）
  5. **等待确认**：等待用户输入 "Act" 后再继续执行

- **问题说明要求**：
  - 必须明确说明发现的具体问题
  - 必须说明问题的影响范围
  - 必须说明修正方案与原方案的区别

- **禁止的行为**：
  - ❌ 继续执行，忽略发现的问题
  - ❌ 不说明问题，直接修正
  - ❌ 不返回 Plan 模式，在 Act 模式下直接修正方案
- **规则文件修改的特殊处理**：
  - 修改规则文件本身（如 `plan-act-mode.md`、`.cursorrules` 等）也必须遵循 Plan 模式
  - 修改规则文件前，必须输出详细的修改方案和计划
  - 修改规则文件后，必须运行合并脚本更新主规则文件
  - 规则文件的修改具有更高的风险，需要特别谨慎

